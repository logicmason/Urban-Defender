import ui.*;class ui.Menu{        private static var ROUNDING:Number = 12;    private static var SPACER:Number = 8;    private static var MARGINS:Number = 4;        private static var _activeMenu:Menu;    private var _items:Array;    private var _text:String;        private var _title:TextField;    private var _clip:MovieClip;        public static function set menu(m:Menu):Void    {        if( _activeMenu )            _activeMenu.destroy();                _activeMenu = m;        _activeMenu.create();    }    public function Menu( title:String, items:Array )    {        _text = title;        _items = items.concat();        for( var i:Number = 0; i < _items.length; i++ )            _items[i].addEventListener( MenuItem.CHANGED, redraw );    }        private function destroy():Void    {        _clip.removeMovieClip();    }    private function create():Void    {        _clip = Init.clip.createEmptyMovieClip( '_menu', Init.clip.getNextHighestDepth() );        _clip._x = _clip._y = MARGINS;        // --- Menu title        _clip.createTextField( '_menuTitle', _clip.getNextHighestDepth(), 0, 0, 1, 1 );        _title = _clip._menuTitle;        _title.setTextFormat( new TextFormat( '_sans', 16, 0 ) );        _title.text = _text;        _title.autoSize = 'left';        _title.selectable = false;                // ---        for( var i:Number = 0; i < _items.length; i++ )                        _items[i].create( _clip );        redraw();    }    public function get contentWidth():Number    {        var m:Number = _title._width;               for( var i:Number = 0; i < _items.length; i++ )                  m = Math.max( _items[i].contentWidth, m );                return m;    }        private function redraw():Void    {        var edge:Number = _title._height + MARGINS;        var dy:Number = edge + SPACER;        var w:Number = contentWidth;        _title._y = MARGINS;        _title._x = MARGINS;        for( var i:Number = 0; i < _items.length; i++ )        {            var item:MenuItem = _items[i];                        item.x = MARGINS;            item.y = dy;            item.width = w;                        dy += item.contentHeight;        }        _clip.clear();        _clip.lineStyle( 3, 0x404040, 100, true );        _clip.beginFill( 0x404040 );        Drawing.drawRoundedBox( _clip, 0, 0, w + MARGINS * 2, dy + MARGINS, ROUNDING, ROUNDING );        _clip.endFill();        _clip.beginFill( 0xFFFFFF );        Drawing.drawRoundedBox( _clip, 0, 0, w + MARGINS * 2, edge + MARGINS, ROUNDING, ROUNDING );        _clip.endFill();    }}